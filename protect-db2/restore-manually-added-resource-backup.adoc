---
permalink: protect-db2/restore-manually-added-resource-backup.html 
sidebar: sidebar 
keywords: SnapCenter Plug-in for IBM Db2 
summary: Você pode usar o SnapCenter para restaurar e recuperar dados de um ou mais backups. 
---
= Restaurar um backup de recurso adicionado manualmente
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Você pode usar o SnapCenter para restaurar e recuperar dados de um ou mais backups.

.Antes de começar
* Você deve ter feito backup do recurso ou dos grupos de recursos.
* Você deve ter cancelado qualquer operação de backup que esteja em andamento para o recurso ou grupo de recursos que deseja restaurar.
* Para comandos de pré-restauração, pós-restauração, montagem e desmontagem, você deve verificar se os comandos existem na lista de comandos disponível no host do plug-in nos seguintes caminhos:
+
** Local padrão no host do Windows: _C:\Arquivos de Programas\ NetApp\ SnapCenter\Snapcenter Plug-in Creator\etc\allowed_commands.config_
** Local padrão no host Linux: _/opt/ NetApp/snapcenter/scc/etc/allowed_commands.config_





NOTE: Se os comandos não existirem na lista de comandos, a operação falhará.

.Sobre esta tarefa
* Para o ONTAP 9.12.1 e versões anteriores, os clones criados a partir dos SnapLock Vault Snapshots como parte da restauração herdarão o tempo de expiração do SnapLock Vault. O administrador de armazenamento deve limpar manualmente os clones após o tempo de expiração do SnapLock .


[role="tabbed-block"]
====
.Interface do usuário do SnapCenter
--
.Passos
. No painel de navegação esquerdo, clique em *Recursos* e selecione o plug-in apropriado na lista.
. Na página Recursos, filtre os recursos da lista suspensa *Exibir* com base no tipo de recurso.
+
Os recursos são exibidos junto com o tipo, host, grupos de recursos e políticas associados e status.

+

NOTE: Embora um backup possa ser para um grupo de recursos, ao restaurar, você deve selecionar os recursos individuais que deseja restaurar.

+
Se o recurso não estiver protegido, "`Não protegido`" será exibido na coluna Status geral.  Isso pode significar que o recurso não está protegido ou que o backup do recurso foi feito por um usuário diferente.

. Selecione o recurso ou selecione um grupo de recursos e depois selecione um recurso nesse grupo.
+
A página de topologia de recursos é exibida.

. Na exibição Gerenciar cópias, selecione *Backups* dos sistemas de armazenamento primário ou secundário (espelhado ou em cofre).
. Na tabela Backup(s) primário(s), selecione o backup que deseja restaurar e clique em *image:../media/restore_icon.gif["ícone de restauração"] *.
+
image::../media/restoring_resource.gif[restaurando recursos]

. Na página Escopo de restauração, selecione *Recurso completo*.
+
.. Se você selecionar *Recurso Completo*, todos os volumes de dados configurados do banco de dados IBM Db2 serão restaurados.
+
Se o recurso contiver volumes ou qtrees, os Snapshots tirados após o Snapshot selecionado para restauração nesses volumes ou qtrees serão excluídos e não poderão ser recuperados.  Além disso, se qualquer outro recurso estiver hospedado nos mesmos volumes ou qtrees, esse recurso também será excluído.

+
Você pode selecionar vários LUNs.



+

NOTE: Se você selecionar *Todos*, todos os arquivos nos volumes, qtrees ou LUNs serão restaurados.

. Na página Pré-operações, insira os comandos pre restore e unmount para executar antes de realizar um trabalho de restauração.
. Na página Post ops, insira os comandos mount e post restore para serem executados após realizar um trabalho de restauração.
. Na página Notificação, na lista suspensa *Preferência de e-mail*, selecione os cenários nos quais você deseja enviar os e-mails.
+
Você também deve especificar os endereços de e-mail do remetente e do destinatário e o assunto do e-mail.  O SMTP também deve ser configurado na página *Configurações* > *Configurações globais*.

. Revise o resumo e clique em *Concluir*.
. Monitore o progresso da operação clicando em *Monitorar* > *Trabalhos*.


.Depois que você terminar
A recuperação só é possível se o status do Rollforward estiver em "BD pendente".  Este status é aplicável a bancos de dados Db2 com registro de arquivamento habilitado.

--
.Cmdlets do PowerShell
--
.Passos
. Inicie uma sessão de conexão com o SnapCenter Server para um usuário especificado usando o cmdlet Open-SmConnection.
+
[listing]
----
PS C:\> Open-SmConnection
----
. Identifique o backup que você deseja restaurar usando os cmdlets Get-SmBackup e Get-SmBackupReport.
+
Este exemplo mostra que há dois backups disponíveis para a restauração:

+
[listing]
----
 PS C:\> Get-SmBackup -AppObjectId cn24.sccore.test.com\DB2\db2inst1\Library

        BackupId    BackupName                    BackupTime            BackupType
        --------    ----------                    ----------            ----------
         1          Payroll Dataset_vise-f6_08... 8/4/2015 11:02:32 AM  Full Backup
         2          Payroll Dataset_vise-f6_08... 8/4/2015 11:23:17 AM
----
+
Este exemplo exibe informações detalhadas sobre o backup de 29 de janeiro de 2015 a 3 de fevereiro de 2015:

+
[listing]
----
PS C:\> Get-SmBackupReport -FromDateTime "1/29/2015" -ToDateTime "2/3/2015"

SmBackupId           : 113
   SmJobId              : 2032
   StartDateTime        : 2/2/2015 6:57:03 AM
   EndDateTime          : 2/2/2015 6:57:11 AM
   Duration             : 00:00:07.3060000
   CreatedDateTime      : 2/2/2015 6:57:23 AM
   Status               : Completed
   ProtectionGroupName  : Clone
   SmProtectionGroupId  : 34
   PolicyName           : Vault
   SmPolicyId           : 18
   BackupName           : Clone_SCSPR0019366001_02-02-2015_06.57.08
   VerificationStatus   : NotVerified

   SmBackupId           : 114
   SmJobId              : 2183
   StartDateTime        : 2/2/2015 1:02:41 PM
   EndDateTime          : 2/2/2015 1:02:38 PM
   Duration             : -00:00:03.2300000
   CreatedDateTime      : 2/2/2015 1:02:53 PM
   Status               : Completed
   ProtectionGroupName  : Clone
   SmProtectionGroupId  : 34
   PolicyName           : Vault
   SmPolicyId           : 18
   BackupName           : Clone_SCSPR0019366001_02-02-2015_13.02.45
   VerificationStatus   : NotVerified
----
. Restaure os dados do backup usando o cmdlet Restore-SmBackup.
+

NOTE: AppObjectId é "Host\Plugin\UID", onde UID = <nome_da_instância> é para o recurso de instância do DB2 descoberto manualmente e UID = <nome_da_instância>\<nome_do_banco_de_dados> é para o recurso de banco de dados IBM Db2.  Você pode obter o ResourceID no cmdlet Get-smResources.

+
[listing]
----
Get-smResources  -HostName cn24.sccore.test.com  -PluginCode DB2
----
+
Este exemplo mostra como restaurar o banco de dados do armazenamento primário:

+
[listing]
----
Restore-SmBackup -PluginCode DB2 -AppObjectId cn24.sccore.test.com\DB2\db2inst1\DB01 -BackupId 3
----
+
Este exemplo mostra como restaurar o banco de dados do armazenamento secundário:

+
[listing]
----
Restore-SmBackup -PluginCode 'DB2' -AppObjectId cn24.sccore.test.com\DB2\db2inst1\DB01 -BackupId 399 -Confirm:$false  -Archive @( @{"Primary"="<Primary Vserver>:<PrimaryVolume>";"Secondary"="<Secondary Vserver>:<SecondaryVolume>"})
----
+
As informações sobre os parâmetros que podem ser usados com o cmdlet e suas descrições podem ser obtidas executando _Get-Help command_name_. Alternativamente, você também pode consultar o https://docs.netapp.com/us-en/snapcenter-cmdlets/index.html["Guia de referência do cmdlet do software SnapCenter"^] .



--
====