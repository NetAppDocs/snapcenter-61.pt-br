---
permalink: protect-sco/task_create_backup_policies_for_oracle_database.html 
sidebar: sidebar 
keywords: backup policies, policies 
summary: Antes de usar o SnapCenter para fazer backup de recursos do banco de dados Oracle, você deve criar uma política de backup para o recurso ou grupo de recursos do qual deseja fazer backup.  Uma política de backup é um conjunto de regras que regem como você gerencia, agenda e mantém backups.  Você também pode especificar as configurações de replicação, script e tipo de backup.  Criar uma política economiza tempo quando você deseja reutilizá-la em outro recurso ou grupo de recursos. 
---
= Crie políticas de backup para bancos de dados Oracle
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Antes de usar o SnapCenter para fazer backup de recursos do banco de dados Oracle, você deve criar uma política de backup para o recurso ou grupo de recursos do qual deseja fazer backup.  Uma política de backup é um conjunto de regras que regem como você gerencia, agenda e mantém backups.  Você também pode especificar as configurações de replicação, script e tipo de backup.  Criar uma política economiza tempo quando você deseja reutilizá-la em outro recurso ou grupo de recursos.

*Antes de começar*

* Você deve ter definido sua estratégia de backup.
* Você deve estar preparado para a proteção de dados concluindo tarefas como instalar o SnapCenter, adicionar hosts, descobrir bancos de dados e criar conexões de sistema de armazenamento.
* Se você estiver replicando Snapshots para um espelho ou armazenamento secundário de cofre, o administrador do SnapCenter deverá ter atribuído as SVMs a você para os volumes de origem e destino.
* Se você instalou o plug-in como um usuário não root, deverá atribuir manualmente as permissões de execução aos diretórios prescript e postscript.
* Revise os pré-requisitos e limitações específicos da sincronização ativa do SnapMirror . Para obter informações, consulte https://docs.netapp.com/us-en/ontap/smbc/considerations-limits.html#volumes["Limites de objetos para sincronização ativa do SnapMirror"] .


.Sobre esta tarefa
Se a opção 'Manter as cópias de backup por um número específico de dias' for selecionada, o período de retenção do SnapLock deverá ser menor ou igual aos dias de retenção mencionados.

+ Especificar um período de bloqueio de Snapshot impede a exclusão dos Snapshots até que o período de retenção expire. Isso pode levar à retenção de um número maior de Snapshots do que a contagem especificada na política.

+ Para o ONTAP 9.12.1 e versões anteriores, os clones criados a partir dos Snapshots do SnapLock Vault como parte da restauração herdarão o tempo de expiração do SnapLock Vault. O administrador de armazenamento deve limpar manualmente os clones após o tempo de expiração do SnapLock .

*Passos*

. No painel de navegação esquerdo, clique em *Configurações*.
. Na página Configurações, clique em *Políticas*.
. Selecione *Oracle Database* na lista suspensa.
. Clique em *Novo*.
. Na página Nome, insira o nome e os detalhes da política.
. Na página Tipo de política, execute as seguintes etapas:
+
.. Selecione seu tipo de armazenamento.
.. Selecione o escopo da política:
+
*** Se você quiser *criar um backup on-line*, selecione *Backup on-line*.
+
Você deve especificar se deseja fazer backup de todos os arquivos de dados, arquivos de controle e arquivos de log de arquivamento, somente dos arquivos de dados e arquivos de controle ou somente dos arquivos de log de arquivamento.

*** Se você quiser *criar um backup offline*, selecione *Backup offline* e, em seguida, selecione uma das seguintes opções:
+
**** Se você quiser criar um backup offline quando o banco de dados estiver no estado montado, selecione *Montar*.
**** Se você quiser criar um backup de desligamento offline alterando o banco de dados para o estado de desligamento, selecione *Desligar*.
+
Se você tiver bancos de dados plugáveis (PDBs) e quiser salvar o estado dos PDBs antes de criar o backup, selecione *Salvar estado dos PDBs*.  Isso permite que você traga os PDBs ao seu estado original após a criação do backup.





.. Se você quiser catalogar o backup usando o Oracle Recovery Manager (RMAN), selecione *Catalogar backup com o Oracle Recovery Manager (RMAN)*.
+
Você pode executar a catalogação adiada para um backup por vez usando a GUI ou o comando SnapCenter CLI Catalog-SmBackupWithOracleRMAN.

+

NOTE: Se você quiser catalogar backups de um banco de dados RAC, certifique-se de que nenhuma outra tarefa esteja em execução para esse banco de dados.  Se outra tarefa estiver em execução, a operação de catalogação falhará em vez de ser enfileirada.

.. Se você quiser remover logs de arquivo após o backup, selecione *Remover logs de arquivo após o backup*.
+

NOTE: A remoção de logs de arquivo do destino de log de arquivo que não está configurado no banco de dados será ignorada.

+

IMPORTANT: Se estiver usando o Oracle Standard Edition, você poderá usar os parâmetros LOG_ARCHIVE_DEST e LOG_ARCHIVE_DUPLEX_DEST ao executar o backup do log de arquivamento.

+
*** Você pode excluir logs de arquivamento somente se tiver selecionado os arquivos de log de arquivamento como parte do seu backup.
+

NOTE: Você deve garantir que todos os nós em um ambiente RAC possam acessar todos os locais de log de arquivamento para que a operação de exclusão seja bem-sucedida.

+
|===
| Se você quiser... | Então... 


 a| 
Excluir todos os logs de arquivo
 a| 
Selecione *Excluir todos os logs de arquivo*.



 a| 
Excluir logs de arquivo mais antigos
 a| 
Selecione *Excluir logs de arquivo mais antigos que* e especifique a idade dos logs de arquivo que devem ser excluídos em dias e horas.



 a| 
Excluir logs de arquivo de todos os destinos
 a| 
Selecione *Excluir logs de arquivo de todos os destinos*.



 a| 
Excluir os logs de arquivamento dos destinos de log que fazem parte do backup
 a| 
Selecione *Excluir logs de arquivo dos destinos que fazem parte do backup*.

|===
+
image:../media/sco_backuppolicy_prunning.gif["política de poda"]





. Na página Snapshot e Replicação, execute as seguintes etapas:
+
.. Especifique a frequência da programação selecionando *Sob demanda*, *Por hora*, *Diariamente*, *Semanalmente* ou *Mensalmente*.
+

NOTE: Você pode especificar o agendamento (data de início e data de término) para a operação de backup ao criar um grupo de recursos.  Isso permite que você crie grupos de recursos que compartilham a mesma política e frequência de backup, mas permite que você atribua agendamentos de backup diferentes a cada política.

+

NOTE: Se você agendou para 2h00, a programação não será acionada durante o horário de verão (DST).

.. Na seção Configurações de retenção de instantâneo de dados, especifique as configurações de retenção para o tipo de backup e o tipo de agendamento selecionado na página Tipo de backup:
+
|===


| Se você quiser... | Então... 


 a| 
Mantenha um certo número de Snapshots
 a| 
Selecione *Cópias a serem mantidas* e especifique o número de Snapshots que você deseja manter.

Se o número de Snapshots exceder o número especificado, os Snapshots serão excluídos, com as cópias mais antigas sendo excluídas primeiro.


NOTE: O valor máximo de retenção é 1018. Os backups falharão se a retenção for definida como um valor maior do que o suportado pela versão subjacente do ONTAP .


IMPORTANT: Você deve definir a contagem de retenção como 2 ou mais se planeja habilitar a replicação do SnapVault .  Se você definir a contagem de retenção como 1, a operação de retenção poderá falhar porque o primeiro Snapshot será o Snapshot de referência para o relacionamento SnapVault até que um Snapshot mais recente seja replicado para o destino.



 a| 
Mantenha os Snapshots por um certo número de dias
 a| 
Selecione *Manter cópias por* e especifique o número de dias pelos quais você deseja manter os Snapshots antes de excluí-los.



 a| 
Período de bloqueio de cópia de instantâneo
 a| 
Selecione o *Período de bloqueio de cópia de instantâneo* e especifique a duração em dias, meses ou anos.

O período de retenção do SnapLock deve ser inferior a 100 anos.

|===
.. Na seção Configurações de retenção de instantâneo do Archive Log, especifique as configurações de retenção para o tipo de backup e o tipo de agendamento selecionado na página Tipo de backup:
+
|===


| Se você quiser... | Então... 


 a| 
Mantenha um certo número de Snapshots
 a| 
Selecione *Cópias a serem mantidas* e especifique o número de Snapshots que você deseja manter.

Se o número de Snapshots exceder o número especificado, os Snapshots serão excluídos, com as cópias mais antigas sendo excluídas primeiro.


NOTE: O valor máximo de retenção é 1018. Os backups falharão se a retenção for definida como um valor maior do que o suportado pela versão subjacente do ONTAP .


IMPORTANT: Você deve definir a contagem de retenção como 2 ou mais se planeja habilitar a replicação do SnapVault .  Se você definir a contagem de retenção como 1, a operação de retenção poderá falhar porque o primeiro Snapshot será o Snapshot de referência para o relacionamento SnapVault até que um Snapshot mais recente seja replicado para o destino.



 a| 
Mantenha os Snapshots por um certo número de dias
 a| 
Selecione *Manter cópias por* e especifique o número de dias pelos quais você deseja manter os Snapshots antes de excluí-los.



 a| 
Período de bloqueio de cópia de instantâneo
 a| 
Selecione o *Período de bloqueio de cópia de instantâneo* e especifique a duração em dias, meses ou anos.

O período de retenção do SnapLock deve ser inferior a 100 anos.

|===
.. Selecione o rótulo da política.
+

NOTE: Você pode atribuir rótulos SnapMirror a snapshots primários para replicação remota, permitindo que os snapshots primários descarreguem a operação de replicação de snapshots do SnapCenter para sistemas secundários ONTAP . Isso pode ser feito sem habilitar a opção SnapMirror ou SnapVault na página de política.



. Na seção Selecionar opções de replicação secundária, selecione uma ou ambas as seguintes opções de replicação secundária:
+

NOTE: Você deve selecionar as opções de replicação secundária para que o *Período de bloqueio de cópia de instantâneo secundário* seja efetivo.

+
|===
| Para este campo... | Faça isso... 


 a| 
Atualizar o SnapMirror após criar um Snapshot local
 a| 
Selecione este campo para criar cópias espelhadas dos conjuntos de backup em outro volume (replicação SnapMirror ).

Esta opção deve ser habilitada para sincronização ativa do SnapMirror .

Durante a replicação secundária, o tempo de expiração do SnapLock carrega o tempo de expiração do SnapLock primário.

Clicar no botão *Atualizar* na página Topologia atualiza o tempo de expiração do SnapLock secundário e primário que são recuperados do ONTAP.



 a| 
Atualizar o SnapVault após criar um Snapshot local
 a| 
Selecione esta opção para executar a replicação de backup de disco para disco (backups do SnapVault ).

Quando o SnapLock é configurado somente no secundário do ONTAP conhecido como SnapLock Vault, clicar no botão *Atualizar* na página Topologia atualiza o período de bloqueio no secundário recuperado do ONTAP.

Para mais informações sobre o SnapLock Vault, consulte https://docs.netapp.com/us-en/ontap/snaplock/commit-snapshot-copies-worm-concept.html["Enviar cópias do Snapshot para o WORM em um destino de cofre"]

Ver link:../protect-sco/task_view_oracle_databse_backups_and_clones_in_the_topology_page.html["Visualize backups e clones do banco de dados Oracle na página Topologia"] .



 a| 
Contagem de novas tentativas de erro
 a| 
Insira o número máximo de tentativas de replicação que podem ser permitidas antes que a operação seja interrompida.

|===
+

NOTE: Você deve configurar a política de retenção do SnapMirror no ONTAP para o armazenamento secundário para evitar atingir o limite máximo de Snapshots no armazenamento secundário.

. Na página Script, insira o caminho e os argumentos do prescript ou postscript que você deseja executar antes ou depois da operação de backup, respectivamente.
+
Você deve armazenar os prescrições e pós-escritos em _/var/opt/snapcenter/spl/scripts_ ou em qualquer pasta dentro deste caminho.  Por padrão, o caminho _/var/opt/snapcenter/spl/scripts_ é preenchido.  Se você criou alguma pasta dentro desse caminho para armazenar os scripts, você deve especificar essas pastas no caminho.

+
Você também pode especificar o valor do tempo limite do script. O valor padrão é 60 segundos.

+
O SnapCenter permite que você use as variáveis ​​de ambiente predefinidas ao executar o prescript e o postscript.link:../protect-sco/predefined-environment-variables-prescript-postscript-backup.html["Saber mais"^]

. Na página Verificação, execute as seguintes etapas:
+
.. Selecione o agendamento de backup para o qual você deseja executar a operação de verificação.
.. Na seção Comandos do script de verificação, insira o caminho e os argumentos do prescript ou postscript que você deseja executar antes ou depois da operação de verificação, respectivamente.
+
Você deve armazenar os prescrições e pós-escritos em _/var/opt/snapcenter/spl/scripts_ ou em qualquer pasta dentro deste caminho.  Por padrão, o caminho _/var/opt/snapcenter/spl/scripts_ é preenchido.  Se você criou alguma pasta dentro desse caminho para armazenar os scripts, você deve especificar essas pastas no caminho.

+
Você também pode especificar o valor do tempo limite do script. O valor padrão é 60 segundos.



. Revise o resumo e clique em *Concluir*.

